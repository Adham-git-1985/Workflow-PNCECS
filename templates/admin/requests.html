{% extends "layout.html" %}
{% block title %}Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…{% endblock %}

{% block content %}

{% include "components/advanced_filters.html" %}

<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h3 class="mb-1">ğŸ“‹ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h3>
        <small class="text-muted">Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù…Ø¹ Ø¥Ù…ÙƒØ§Ù†ÙŠØ§Øª Ø§Ù„ÙÙ„ØªØ±Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</small>
    </div>
</div>

<div class="card shadow-sm">
    <div class="card-body p-0">

        {% if requests %}
        <div class="table-responsive">
            <table class="table table-hover align-middle mb-0">
                <thead class="table-light">
                    <tr>
                        <th>#</th>
                        <th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                        <th class="text-center">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡</th>
                        <th class="text-center">Ø§Ù„Ø¯ÙˆØ± Ø§Ù„Ø­Ø§Ù„ÙŠ</th>
                        <th class="text-center">SLA</th>
                        <th class="text-center">Ø¥Ø¬Ø±Ø§Ø¡</th>
                    </tr>
                </thead>
                <tbody>
                {% for req in requests %}
                    <tr>
                        <td>{{ req.id }}</td>
                        <td>
                            <strong>{{ req.title }}</strong>
                        </td>
                        <td>
                            <span class="badge
                                {% if req.status == 'APPROVED' %}bg-success
                                {% elif req.status == 'REJECTED' %}bg-danger
                                {% elif req.status == 'DRAFT' %}bg-secondary
                                {% else %}bg-warning text-dark{% endif %}">
                                {{ req.status }}
                            </span>
                        </td>
                        <td class="text-center">
                            {{ req.created_at.strftime("%Y-%m-%d") }}
                        </td>
                        <td class="text-center">
                            <span class="badge bg-info">
                                {{ req.current_role }}
                            </span>
                        </td>
                        <td class="text-center">
                            {% set sla = get_sla_state(req) %}
                            {% if sla == "ON_TRACK" %}
                                <span class="badge bg-success">On Track</span>
                            {% elif sla == "BREACHED" %}
                                <span class="badge bg-warning text-dark">Breached</span>
                            {% elif sla == "ESCALATED" %}
                                <span class="badge bg-danger">Escalated</span>
                            {% else %}
                                <span class="text-muted">â€”</span>
                            {% endif %}
                        </td>
                        <td class="text-center">
                            <a href="{{ url_for('review_request', request_id=req.id) }}"
                               class="btn btn-sm btn-outline-primary">
                                Ø¹Ø±Ø¶
                            </a>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="p-4 text-center text-muted">
            Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙÙ„ØªØ±Ø©
        </div>
        {% endif %}

    </div>
</div>

{% endblock %}
