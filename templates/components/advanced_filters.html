<form method="get" class="card shadow-sm mb-4">

  <div class="card-header d-flex justify-content-between align-items-center">
    <strong>Advanced Filters</strong>
    <button type="button"
            class="btn btn-sm btn-outline-secondary"
            data-bs-toggle="collapse"
            data-bs-target="#advanced-filters-body">
      Toggle
    </button>
  </div>

  <div id="advanced-filters-body" class="card-body collapse show">
    <div class="row g-3">

      <!-- Status -->
      <div class="col-md-3">
        <label class="form-label">Status</label>
        <select name="status" multiple class="form-select">
          {% for s in ["DRAFT","IN_PROGRESS","APPROVED","REJECTED"] %}
            <option value="{{ s }}"
              {% if s in request.args.getlist("status") %}selected{% endif %}>
              {{ s.replace("_"," ").title() }}
            </option>
          {% endfor %}
        </select>
      </div>

      <!-- Date From -->
      <div class="col-md-3">
        <label class="form-label">From</label>
        <input type="date"
               name="date_from"
               value="{{ request.args.get('date_from','') }}"
               class="form-control">
      </div>

      <!-- Date To -->
      <div class="col-md-3">
        <label class="form-label">To</label>
        <input type="date"
               name="date_to"
               value="{{ request.args.get('date_to','') }}"
               class="form-control">
      </div>

      <!-- Keyword -->
      <div class="col-md-3">
        <label class="form-label">Keyword</label>
        <input type="text"
               name="keyword"
               value="{{ request.args.get('keyword','') }}"
               class="form-control"
               placeholder="ID, title, description">
      </div>

      <!-- SLA Status -->
      <div class="col-md-3">
        <label class="form-label">SLA Status</label>
        <select name="sla_state" class="form-select">
          <option value="">All</option>
          <option value="ON_TRACK"
            {% if request.args.get("sla_state") == "ON_TRACK" %}selected{% endif %}>
            On Track
          </option>
          <option value="BREACHED"
            {% if request.args.get("sla_state") == "BREACHED" %}selected{% endif %}>
            Breached
          </option>
          <option value="ESCALATED"
            {% if request.args.get("sla_state") == "ESCALATED" %}selected{% endif %}>
            Escalated
          </option>
        </select>
      </div>

      {% if is_admin %}
      <!-- Requester ID -->
      <div class="col-md-3">
        <label class="form-label">Requester ID</label>
        <input type="number"
               name="requester_id"
               value="{{ request.args.get('requester_id','') }}"
               class="form-control">
      </div>

      <!-- Current Role -->
      <div class="col-md-3">
        <label class="form-label">Current Role</label>
        <input type="text"
               name="current_role"
               value="{{ request.args.get('current_role','') }}"
               class="form-control"
               placeholder="finance, secretary_generalâ€¦">
      </div>
      {% endif %}

    </div>

    <!-- Actions -->
    <div class="mt-4 d-flex justify-content-end gap-2">
      <button type="submit" class="btn btn-primary">
        Apply
      </button>
      <a href="{{ request.path }}" class="btn btn-outline-secondary">
        Reset
      </a>
    </div>
  </div>

</form>
