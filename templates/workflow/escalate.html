{% extends "layout.html" %}
{% block title %}ุชุตุนูุฏ ุงูุทูุจ{% endblock %}
{% block content %}

<div class="d-flex justify-content-between align-items-center mb-4">
  <div>
    <h3 class="mb-1">๐จ ุชุตุนูุฏ ุงูุทูุจ #{{ req.id }}</h3>
    <small class="text-muted">{{ req.title }}</small>
  </div>
  <a class="btn btn-outline-secondary" href="{{ url_for('workflow.view_request', request_id=req.id) }}">ุฑุฌูุน</a>
</div>

<div class="alert alert-warning">
  <div class="mb-1"><b>ุงูุฎุทูุฉ ุงูุญุงููุฉ:</b> {{ step_order }} | <b>ุงูุฌูุฉ ุงููุณุคููุฉ:</b> {{ target_label }}</div>
  <div class="small text-muted">
    ุนูุฏ ุงูุฅุฑุณุงูุ ุณูุชู ุฅูุดุงุก ุชูุจูู <b>Warning</b> + ุฑุณุงูุฉ ูู <b>ุงููุฑุงุณูุงุช</b> ููุฌูุฉ ุงูุชู ุนูุฏูุง ุงูุฎุทูุฉุ ุจุงูุฅุถุงูุฉ ุฅูู <b>ูุฏูุฑ ุนุงู ุงูุฅุฏุงุฑุฉ (directorate_head)</b>.
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-body">

    <div class="mb-3">
      <label class="form-label">ุณูุชู ุชูุฌูู ุงูุชุตุนูุฏ ุฅูู</label>
      <div>
        {% if recipients %}
          {% for u in recipients %}
            <span class="badge bg-light text-dark border">{{ u.email }}</span>
          {% endfor %}
        {% else %}
          <span class="text-muted">ูุง ููุฌุฏ ูุณุชูููู ูุนุฑููู ููุฎุทูุฉ ุงูุญุงููุฉ.</span>
        {% endif %}
      </div>
    </div>

    <form method="post" novalidate>
      <div class="row g-3">
        <div class="col-md-4">
          <label class="form-label">ููุน ุงูุชุตุนูุฏ</label>
          <select class="form-select" name="category" required>
            {% for c in categories %}
              {# keep DB value as code, but show Arabic label to users #}
              <option value="{{ c }}">{{ c|esc_category_ar }}</option>
            {% endfor %}
          </select>
        </div>

        <div class="col-12">
          <label class="form-label">ูุตู ุงูุชุตุนูุฏ</label>
          <textarea class="form-control" name="description" rows="4" required placeholder="ุงูุชุจ ุณุจุจ/ุชูุงุตูู ุงูุชุตุนูุฏ"></textarea>
        </div>
      </div>

      <hr class="my-4">

      <button class="btn btn-danger" {% if not recipients %}disabled{% endif %}>ุฅุฑุณุงู ุงูุชุตุนูุฏ</button>
      <a class="btn btn-outline-secondary" href="{{ url_for('workflow.view_request', request_id=req.id) }}">ุฅูุบุงุก</a>
    </form>
  </div>
</div>

{% endblock %}
