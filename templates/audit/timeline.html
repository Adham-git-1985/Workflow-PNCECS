{% extends "layout.html" %}
{% block content %}

<h3 class="mb-4">üß≠ System Activity Timeline</h3>

<div class="card shadow-sm">
    <div class="card-body">

        {% if logs %}
        <ul class="timeline list-unstyled m-0">

        {% for log in logs %}
        <li class="timeline-item d-flex mb-4">

            <!-- Time -->
            <div class="timeline-time text-center text-muted me-4">
                <div class="fw-bold">
                    {{ log.created_at.strftime("%Y-%m-%d") }}
                </div>
                <small>
                    {{ log.created_at.strftime("%H:%M") }}
                </small>
            </div>

            <!-- Content -->
            <div class="timeline-content flex-grow-1 p-3 border rounded bg-light">

                <!-- Header -->
                <div class="d-flex justify-content-between align-items-center">
                    <span class="badge bg-primary">
                        {{ log.action }}
                    </span>
                </div>

                <!-- Message -->
                <p class="mt-3 mb-2">
                    {{ log.note or "‚Äî" }}
                </p>

                <!-- Meta -->
                <div class="text-muted small d-flex flex-wrap gap-2">

                    {% if log.user %}
                        üë§ <strong>{{ log.user.email }}</strong>
                    {% else %}
                        ü§ñ <strong>System</strong>
                    {% endif %}

                    {% if log.target_type %}
                        <span>‚Ä¢</span>

                        {% if log.target_type == "WorkflowRequest" %}
                            üìÑ
                            <a href="{{ url_for('review_request', request_id=log.target_id) }}">
                                Request #{{ log.target_id }}
                            </a>

                        {% elif log.target_type == "ArchivedFile" %}
                            üóÇÔ∏è
                            <a href="{{ url_for('archive.my_files') }}">
                                Archived File #{{ log.target_id }}
                            </a>

                        {% elif log.target_type == "User" %}
                            üë§ User #{{ log.target_id }}
                        {% endif %}
                    {% endif %}
                </div>

            </div>
        </li>
        {% endfor %}

        </ul>
        {% else %}
        <div class="text-center text-muted py-4">
            ŸÑÿß ŸäŸàÿ¨ÿØ ŸÜÿ¥ÿßÿ∑ ŸÖÿ≥ÿ¨ŸëŸÑ
        </div>
        {% endif %}

    </div>
</div>

{% endblock %}
